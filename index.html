<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>C^3 Form App</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <style>
            @import url('https://fonts.googleapis.com/css2?family=Open+Sans:wght@500&family=Press+Start+2P&display=swap');
        </style>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
        <link rel="stylesheet" type="text/css" href="style/stylesheet.css">
        <script defer src="halo/test.js"></script>
    </head>
    <body><div class="title">            <p class="mainTitle">C^3 Form App</p>
</div>
        <div class="container">
        <div>
            <p class="mainTitleSubText">
                The <b>Custom Computer Configuration Form App</b> is a template application that allows you to modify a pre-built PowerShell script with information specific to a new PC configuration.
            </p>
            <p class="mainTitleSubText">
                <b>DIRECTIONS: </b>Fill in the form on the <b>LEFT</b> with the <b>NEW USER</b> information that should be added to the custom PowerShell script on the <B>RIGHT</B>.
            </p> 
        
        </div>

        <div class="container text-center">        
            <hr>
            <div class="row">
                <div class="col">
                    <div class="form" id='columRight'>
                
                        <!-- COLUMN 01: Form -->
                        <!-- <div class="input-group" id="diffCounter"> -->
                            <h3 class='columnTitle'>INPUT COLUMN</h3>
                            <p class="alert alert-success" role="alert" id="messageBox">
                                The form data will be added to the PowerShell script within the right column.
                            </p>
                        <!-- </div> -->
                        
                        <!-- Input section of old filename. -->
                        <form>
                            <!-- <div class="input-group mb-3"> -->
                                <label for ="userName" class="label">New User Account Name:</label>
                                <br>
                                <input type="text" class="form-control" placeholder="Username Here!" aria-label="Recipient's username" aria-describedby="basic-addon2" id="inputName">

                                <label for ="userName" class="label">New User Login Password:</label>
                                <br>
                                <input type="text" class="form-control" placeholder="Password Here!" aria-label="Recipient's username" aria-describedby="basic-addon2" id="inputPW">

                            <!-- </div> -->
                        </form>
            
                        <!-- <p>Gondor vs Vulcan Deployment Test</p> -->
                        
                        <!-- Test -->
                        <!-- <input id="goku" placeholder="Enter some text" name="name" />
                        <p id="vegeta"></p> -->
                    </div>
                </div>

                <div class="col">
                    <!-- COLUMN 02: Modified PowerShell Text -->
                    <div class="form">    
                        
                        <h3 class='columnTitle'>SCRIPT COLUMN</h3>
                        <div class="alert alert-success" role="alert" id="messageBox2">
                            <p class="typewriter">"Add new user and password" Powershell script below...
                            </p>
                        </div>
                        
                        <button type="button" class="btn btn-dark btn-lg" id="newButton"><i id="icon" class="bi-clipboard-fill"></i></button>

                        <!-- Undescored name component. -->
                        <div class="input-group ">
                            <container>
                            <div class="alert alert-primary" role="alert" id="scriptWin">
                       
<!-- PowerShell Script Goes Here -->
function Use-NewNamePWAdd {
    $value = Read-Host "Press 'a', then 'ENTER' to start the 'New User' account setup step Or 'n' to skip"
    if ( 'a' -eq $value ) {
        $name = "<span id="accountName"></span>"
        Write-Output "New Added Accout Name: $name"
        $pw = "<span id="accountPW"></span>"
        $Password = ConvertTo-SecureString $pw -AsPlainText -Force
        Write-Output "New Added Account Password: $pw"
        $params = @{
            Name        = $name
            Password    = $Password
            FullName    = $name
            Description = 'New user account with password.'
        }
        New-LocalUser @params
        Add-LocalGroupMember -Group "Users" -Member $name
    } elseif ( 'n' -eq $value) {
            Write-Output "Local new user account add step will be skipped."
    } else {
        Use-NewNamePWAdd
    }
}
Use-NewNamePWAdd                          
<!-- End -->

                            </div>
                            </container>
                        </div>

                        <!-- <p>Gondor vs Vulcan Deployment Test</p> -->
                        
                        <!-- Test -->
                        <!-- <input id="goku" placeholder="Enter some text" name="name" />
                        <p id="vegeta"></p> -->
                    </div>
                </div>        
            </div>
        </div>

        </div>
    </body>

</html>